// (c) 2019-2022 0b5vr - https://github.com/0b5vr/experimental-npm/blob/release/LICENSE
function ht(r,t){if(typeof t!="function")return ht(r,i=>i<t);let e=t,o=0,n=r.length;for(;o<n;){let i=o+n>>1,s=r[i];e(s)?o=i+1:n=i}return o}function mr(r,t){let e=r.indexOf(t);return e===-1?!1:(r.splice(e,1),!0)}function cr(r,t){return r.indexOf(t)!==-1}function yr(r,t){return r.indexOf(t)!==-1?!1:(r.push(t),!0)}function gr(r,t){let e=[...r];return t.forEach(o=>{cr(e,o)||e.push(o)}),e}function kr(r,t){let e=[...r];return t.forEach(o=>{mr(e,o)}),e}var Pr=[-1,-1,1,-1,-1,1,1,1],vr=[-1,-1,0,1,-1,0,-1,1,0,1,1,0],Vr=[0,0,1,0,0,1,0,0,1,0,0,1],Sr=[0,0,1,0,0,1,1,1];function Cr(r,t){let e=t||(()=>Math.random());for(let o=0;o<r.length-1;o++){let n=o+Math.floor(e()*(r.length-o)),i=r[n];r[n]=r[o],r[o]=i}return r}function Ar(r){let t=[];for(let e=0;e<r.length/3;e++){let o=e*3;t.push(r[o],r[o+1],r[o+1],r[o+2],r[o+2],r[o])}return t}function Fr(r,t){let e=[];for(let o=0;o<t;o++)for(let n=0;n<r;n++)e.push(n,o);return e}function Er(r,t,e){let o=[];for(let n=0;n<e;n++)for(let i=0;i<t;i++)for(let s=0;s<r;s++)o.push(s,i,n);return o}var ur=class{factor=100;ratio=1;velocity=0;value=0;target=0;update(t){return this.velocity+=(-this.factor*(this.value-this.target)-2*this.velocity*Math.sqrt(this.factor)*this.ratio)*t,this.value+=this.velocity*t,this.value}};var tt=class{__time=0;__deltaTime=0;__isPlaying=!1;get time(){return this.__time}get deltaTime(){return this.__deltaTime}get isPlaying(){return this.__isPlaying}update(t){let e=this.__time;this.__time=t||0,this.__deltaTime=this.__time-e}play(){this.__isPlaying=!0}pause(){this.__isPlaying=!1}setTime(t){this.__time=t}};var pr=class extends tt{__frame=0;__fps;constructor(t=60){super();this.__fps=t}get frame(){return this.__frame}get fps(){return this.__fps}update(){this.__isPlaying?(this.__time=this.__frame/this.__fps,this.__deltaTime=1/this.__fps,this.__frame++):this.__deltaTime=0}setTime(t){this.__frame=Math.floor(this.__fps*t),this.__time=this.__frame/this.__fps}};var lr=class extends tt{__rtTime=0;__rtDate=performance.now();get isRealtime(){return!0}update(){let t=performance.now();if(this.__isPlaying){let e=this.__time,o=t-this.__rtDate;this.__time=this.__rtTime+o/1e3,this.__deltaTime=this.time-e}else this.__rtTime=this.time,this.__rtDate=t,this.__deltaTime=0}setTime(t){this.__time=t,this.__rtTime=this.time,this.__rtDate=performance.now()}};function jt(r,t,e){return r+(t-r)*e}function Mt(r,t,e){return Math.min(Math.max(r,t),e)}function _t(r){return Mt(r,0,1)}function Hr(r,t,e,o,n){return(r-t)*(n-o)/(e-t)+o}function Y(r,t,e){return _t((e-r)/(t-r))}function Nr(r,t,e){let o=Y(r,t,e);return o*o*(3-2*o)}function Br(r,t,e){let o=Y(r,t,e);return o*o*o*(o*(o*6-15)+10)}function Gr(r,t,e){let o=Y(r,t,e);return o*o*o*o*(o*(o*(-20*o+70)-84)+35)}function Yr(r){return"#"+r.map(t=>("0"+Math.round(_t(t)*255).toString(16)).slice(-2)).join("")}function Kr(r){return r.map(t=>t<.081?t/4.5:Math.pow((t+.099)/1.099,1/.45))}function Wr(r){return r.map(t=>t<.018?4.5*t:1.099*Math.pow(t,.45)-.099)}function yt(r,t,e,o){let n=0,i=new Float32Array(o);i[0]=0;let s=new Float32Array(o+1);s[0]=-1/0,s[1]=1/0;let u=new Float32Array(o);for(let a=0;a<o;a++)u[a]=r[t+a*e];for(let a=1;a<o;a++){let m=0;for(;0<=n&&(m=(u[a]+a*a-u[i[n]]-i[n]*i[n])/(2*a-2*i[n]),m<=s[n]);)n--;n++,i[n]=a,s[n]=m,s[n+1]=1/0}n=0;for(let a=0;a<o;a++){for(;s[n+1]<a;)n++;let m=a-i[n];r[t+a*e]=u[i[n]]+m*m}}function fr(r,t,e){for(let o=0;o<t;o++)yt(r,o,t,e);for(let o=0;o<e;o++)yt(r,o*t,1,t)}var hr=class{factor=10;target=0;value=0;update(t){return this.value=jt(this.target,this.value,Math.exp(-this.factor*t)),this.value}};var gt=class{array;index=0;get current(){return this.array[this.index]}constructor(t){this.array=t}next(){return this.index=(this.index+1)%this.array.length,this.current}};var Wt=class{queries;stack;ext;gl;__loopTasks;static isSupported(t){return new Set(t.getSupportedExtensions()).has("EXT_disjoint_timer_query_webgl2")}constructor(t){this.gl=t;let e=new Array(1024).fill(1).map(()=>t.createQuery());this.queries=new gt(e),this.stack=[],this.ext=t.getExtension("EXT_disjoint_timer_query_webgl2"),this.__loopTasks=new Set;let o=()=>{this.update(),requestAnimationFrame(o)};o()}update(){Array.from(this.__loopTasks).forEach(t=>t())}async measure(t){let{gl:e}=this;if(this.stack.length!==0){e.endQuery(this.ext.TIME_ELAPSED_EXT);let i=this.check(this.queries.current);this.stack=this.stack.map(async s=>await s+await i)}this.stack.push(Promise.resolve(0)),e.beginQuery(this.ext.TIME_ELAPSED_EXT,this.queries.next()),t(),e.endQuery(this.ext.TIME_ELAPSED_EXT);let o=this.stack.pop(),n=this.check(this.queries.current);return this.stack.length!==0&&(this.stack=this.stack.map(async i=>await i+await n),e.beginQuery(this.ext.TIME_ELAPSED_EXT,this.queries.next())),await o+await n}check(t){let{gl:e}=this;return new Promise(o=>{let n=()=>{e.getQueryParameter(t,e.QUERY_RESULT_AVAILABLE)&&(this.__loopTasks.delete(n),o(e.getQueryParameter(t,e.QUERY_RESULT)*.001*.001))};this.__loopTasks.add(n)})}};var kt=class{__recalcForEach=0;__countUntilRecalc=0;__history=[];__index=0;__length;__count=0;__cache=0;constructor(t){this.__length=t,this.__recalcForEach=t;for(let e=0;e<t;e++)this.__history[e]=0}get mean(){let t=Math.min(this.__count,this.__length);return t===0?0:this.__cache/t}get recalcForEach(){return this.__recalcForEach}set recalcForEach(t){let e=t-this.__recalcForEach;this.__recalcForEach=t,this.__countUntilRecalc=Math.max(0,this.__countUntilRecalc+e)}reset(){this.__index=0,this.__count=0,this.__cache=0,this.__countUntilRecalc=0;for(let t=0;t<this.__length;t++)this.__history[t]=0}push(t){let e=this.__history[this.__index];this.__history[this.__index]=t,this.__count++,this.__index=(this.__index+1)%this.__length,this.__countUntilRecalc===0?this.recalc():(this.__countUntilRecalc--,this.__cache-=e,this.__cache+=t)}recalc(){this.__countUntilRecalc=this.__recalcForEach;let t=this.__history.slice(0,Math.min(this.__count,this.__length)).reduce((e,o)=>e+o,0);this.__cache=t}};var Tt=class{__history=[];__sorted=[];__index=0;__length;constructor(t){this.__length=t}get median(){return this.percentile(50)}percentile(t){return this.__history.length===0?0:this.__sorted[Math.round(t*.01*(this.__history.length-1))]}reset(){this.__index=0,this.__history=[],this.__sorted=[]}push(t){let e=this.__history[this.__index];if(this.__history[this.__index]=t,this.__index=(this.__index+1)%this.__length,this.__sorted.length===this.__length){let n=ht(this.__sorted,e);this.__sorted.splice(n,1)}let o=ht(this.__sorted,t);this.__sorted.splice(o,0,t)}};var xr=class extends Tt{constructor(t){super(t);console.warn("HistoryMedianCalculator: Deprecated. Use HistoryPercentileCalculator instead")}};var xt=class{map;constructor(){this.map=new Map}get(t){return this.map.get(t)??new Set}add(t,e){let o=this.map.get(t);o==null&&(o=new Set,this.map.set(t,o)),o.add(e)}};function Pt(r){let t=r[0],e=r[1],o=r[2],n=r[3],i=r[4],s=r[5],u=r[6],a=r[7],m=r[8],p=m*i-s*a,c=s*u-m*n,l=a*n-i*u;return t*p+e*c+o*l}function B(r){return[r[0],r[1],r[2],r[4],r[5],r[6],r[8],r[9],r[10]]}function rt(r){let t=r[0],e=r[1],o=r[2],n=r[3];return[1-2*e*e-2*o*o,2*t*e+2*o*n,2*t*o-2*e*n,2*t*e-2*o*n,1-2*t*t-2*o*o,2*e*o+2*t*n,2*t*o+2*e*n,2*e*o-2*t*n,1-2*t*t-2*e*e]}function w(r,t){return r.map(e=>e*t)}function vt(r){let t=r[0],e=r[1],o=r[2],n=r[3],i=r[4],s=r[5],u=r[6],a=r[7],m=r[8],p=m*i-s*a,c=s*u-m*n,l=a*n-i*u,h=t*p+e*c+o*l;return h===0?w(r,0):w([p,o*a-m*e,s*e-o*i,c,m*t-o*u,o*n-s*t,l,e*u-a*t,i*t-e*n],1/h)}function bt(...r){if(r.length<2)return r[0];let t=r.shift(),e=bt(...r),o=t[0],n=t[1],i=t[2],s=t[3],u=t[4],a=t[5],m=t[6],p=t[7],c=t[8],l=e[0],h=e[1],x=e[2],b=e[3],d=e[4],y=e[5],g=e[6],k=e[7],T=e[8];return[o*l+s*h+m*x,n*l+u*h+p*x,i*l+a*h+c*x,o*b+s*d+m*y,n*b+u*d+p*y,i*b+a*d+c*y,o*g+s*k+m*T,n*g+u*k+p*T,i*g+a*k+c*T]}function Vt(r){return[r[0],r[3],r[6],r[1],r[4],r[7],r[2],r[5],r[8]]}var Jt=[1,0,0,0,1,0,0,0,1],P=class{elements;constructor(t=Jt){this.elements=t}get transpose(){return new P(Vt(this.elements))}get determinant(){return Pt(this.elements)}get inverse(){return new P(vt(this.elements))}get matrix4(){return R.fromMatrix3(this)}toString(){let t=this.elements.map(e=>e.toFixed(3));return`Matrix3( ${t[0]}, ${t[3]}, ${t[6]}; ${t[1]}, ${t[4]}, ${t[7]}; ${t[2]}, ${t[5]}, ${t[8]} )`}clone(){return new P(this.elements.concat())}multiply(...t){return P.multiply(this,...t)}scaleScalar(t){return new P(w(this.elements,t))}static get identity(){return new P(Jt)}static multiply(...t){return t.length===0?P.identity:new P(bt(...t.map(e=>e.elements)))}static fromMatrix4(t){return new P(B(t.elements))}static fromQuaternion(t){return new P(rt(t.elements))}};function H(...r){if(r.length<2)return r[0];let t=r.shift(),e=H(...r);return t.map((o,n)=>o+e[n])}function St(r,t){return r.map((e,o)=>e/t[o])}function V(r,t){return r.reduce((e,o,n)=>e+o*t[n],0)}function S(r){return Math.sqrt(r.reduce((t,e)=>t+e*e,0))}function et(r){return r.reduce((t,e)=>t+e*e,0)}function ot(r){return r.reduce((t,e)=>t+Math.abs(e),0)}function wt(...r){if(r.length<2)return r[0];let t=r.shift(),e=wt(...r);return t.map((o,n)=>o*e[n])}function G(r){return r.map(t=>-t)}function v(r){let t=S(r),e=t===0?0:1/t;return w(r,e)}function D(r,t){return r.map((e,o)=>e-t[o])}var Z=class{get length(){return S(this.elements)}get lengthSq(){return et(this.elements)}get manhattanLength(){return ot(this.elements)}get normalized(){return this.__new(v(this.elements))}get negated(){return this.__new(G(this.elements))}clone(){return this.__new(this.elements.concat())}add(...t){return this.__new(H(this.elements,...t.map(e=>e.elements)))}sub(t){return this.__new(D(this.elements,t.elements))}multiply(...t){return this.__new(wt(this.elements,...t.map(e=>e.elements)))}divide(t){return this.__new(St(this.elements,t.elements))}scale(t){return this.__new(w(this.elements,t))}dot(t){return V(this.elements,t.elements)}};function nt(r,t){return[t[0]*r[0]+t[4]*r[1]+t[8]*r[2]+t[12]*r[3],t[1]*r[0]+t[5]*r[1]+t[9]*r[2]+t[13]*r[3],t[2]*r[0]+t[6]*r[1]+t[10]*r[2]+t[14]*r[3],t[3]*r[0]+t[7]*r[1]+t[11]*r[2]+t[15]*r[3]]}function Qt(r,t){let e=nt([...r,1],t),o=[e[0],e[1],e[2]],n=e[3];return w(o,1/n)}function it(r){return[-r[0],-r[1],-r[2],r[3]]}function K(...r){if(r.length<2)return r[0];let t=r.shift(),e=K(...r);return[t[3]*e[0]+t[0]*e[3]+t[1]*e[2]-t[2]*e[1],t[3]*e[1]-t[0]*e[2]+t[1]*e[3]+t[2]*e[0],t[3]*e[2]+t[0]*e[1]-t[1]*e[0]+t[2]*e[3],t[3]*e[3]-t[0]*e[0]-t[1]*e[1]-t[2]*e[2]]}function Ct(r,t){let e=[...r,0],o=it(t),n=K(t,e,o);return n.pop(),n}function Q(r,t){return[r[1]*t[2]-r[2]*t[1],r[2]*t[0]-r[0]*t[2],r[0]*t[1]-r[1]*t[0]]}function at(r,t=[0,1,0],e){let o=v(r),n=v(t),i=V(o,n);i===1&&(Math.abs(o[1])>Math.abs(o[2])?n=[0,0,1]:n=[0,1,0],i=V(o,n)),n=v(D(n,w(o,i)));let s=Q(n,o);return e&&V(s,e)<0&&(s=G(s)),{normal:o,tangent:n,binormal:s}}var M=class extends Z{elements;constructor(t=[0,0,0]){super();this.elements=t}get x(){return this.elements[0]}set x(t){this.elements[0]=t}get y(){return this.elements[1]}set y(t){this.elements[1]=t}get z(){return this.elements[2]}set z(t){this.elements[2]=t}toString(){return`Vector3( ${this.x.toFixed(3)}, ${this.y.toFixed(3)}, ${this.z.toFixed(3)} )`}cross(t){return new M(Q(this.elements,t.elements))}applyQuaternion(t){return new M(Ct(this.elements,t.elements))}applyMatrix4(t){return new M(Qt(this.elements,t.elements))}__new(t){return new M(t)}static get zero(){return new M([0,0,0])}static get one(){return new M([1,1,1])}static orthoNormalize(t,e,o){let n=at(t.elements,e.elements,o.elements);return{normal:new M(n.normal),tangent:new M(n.tangent),binormal:new M(n.binormal)}}};function X(r){let t=r[0],e=r[1],o=r[2],n=r[3];return[1-2*e*e-2*o*o,2*t*e+2*o*n,2*t*o-2*e*n,0,2*t*e-2*o*n,1-2*t*t-2*o*o,2*e*o+2*t*n,0,2*t*o+2*e*n,2*e*o-2*t*n,1-2*t*t-2*e*e,0,0,0,0,1]}function At(r,t,e){let o=X(t),n=e[0],i=e[1],s=e[2];return[o[0]*n,o[1]*n,o[2]*n,0,o[4]*i,o[5]*i,o[6]*i,0,o[8]*s,o[9]*s,o[10]*s,0,r[0],r[1],r[2],1]}function st(r){let t=r[0],e=r[1],o=r[2],n=r[3],i=r[4],s=r[5],u=r[6],a=r[7],m=r[8],p=r[9],c=r[10],l=r[11],h=r[12],x=r[13],b=r[14],d=r[15],y=t*s-e*i,g=t*u-o*i,k=t*a-n*i,T=e*u-o*s,C=e*a-n*s,A=o*a-n*u,F=m*x-p*h,E=m*b-c*h,L=m*d-l*h,q=p*b-c*x,I=p*d-l*x,z=c*d-l*b;return y*z-g*I+k*q+T*L-C*E+A*F}function Ft(r){let t=r[0],e=r[3],o=r[6],n=r[1],i=r[4],s=r[7],u=r[2],a=r[5],m=r[8],p=t+i+m;if(p>0){let c=.5/Math.sqrt(p+1);return[(a-s)*c,(o-u)*c,(n-e)*c,.25/c]}else if(t>i&&t>m){let c=2*Math.sqrt(1+t-i-m);return[.25*c,(e+n)/c,(o+u)/c,(a-s)/c]}else if(i>m){let c=2*Math.sqrt(1+i-t-m);return[(e+n)/c,.25*c,(s+a)/c,(o-u)/c]}else{let c=2*Math.sqrt(1+m-t-i);return[(o+u)/c,(s+a)/c,.25*c,(n-e)/c]}}function mt(r){return Ft(B(r))}function Et(r){let t=S([r[0],r[1],r[2]]),e=S([r[4],r[5],r[6]]),o=S([r[8],r[9],r[10]]);st(r)<0&&(t=-t);let i=1/t,s=1/e,u=1/o,a=r.concat();return a[0]*=i,a[1]*=i,a[2]*=i,a[4]*=s,a[5]*=s,a[6]*=s,a[8]*=u,a[9]*=u,a[10]*=u,{position:[r[12],r[13],r[14]],scale:[t,e,o],rotation:mt(a)}}function Lt(r){return[r[0],r[1],r[2],0,r[3],r[4],r[5],0,r[6],r[7],r[8],0,0,0,0,1]}function qt(r){let t=r[0],e=r[1],o=r[2],n=r[3],i=r[4],s=r[5],u=r[6],a=r[7],m=r[8],p=r[9],c=r[10],l=r[11],h=r[12],x=r[13],b=r[14],d=r[15],y=t*s-e*i,g=t*u-o*i,k=t*a-n*i,T=e*u-o*s,C=e*a-n*s,A=o*a-n*u,F=m*x-p*h,E=m*b-c*h,L=m*d-l*h,q=p*b-c*x,I=p*d-l*x,z=c*d-l*b,N=y*z-g*I+k*q+T*L-C*E+A*F;return N===0?w(r,0):w([s*z-u*I+a*q,o*I-e*z-n*q,x*A-b*C+d*T,c*C-p*A-l*T,u*L-i*z-a*E,t*z-o*L+n*E,b*k-h*A-d*g,m*A-c*k+l*g,i*I-s*L+a*F,e*L-t*I-n*F,h*C-x*k+d*y,p*k-m*C-l*y,s*E-i*q-u*F,t*q-e*E+o*F,x*g-h*T-b*y,m*T-p*g+c*y],1/N)}function It(r,t=[0,0,0],e=[0,1,0],o=0){let n=v(D(r,t)),i=v(Q(e,n));o!==0&&(i=H(w(i,Math.cos(o)),w(Q(n,i),Math.sin(o))));let s=Q(n,i);return[i[0],i[1],i[2],0,s[0],s[1],s[2],0,n[0],n[1],n[2],0,r[0],r[1],r[2],1]}function zt(r,t=[0,0,0],e=[0,1,0],o=0){let n=v(D(r,t)),i=v(Q(e,n));o!==0&&(i=H(w(i,Math.cos(o)),w(Q(n,i),Math.sin(o))));let s=Q(n,i);return[i[0],s[0],n[0],0,i[1],s[1],n[1],0,i[2],s[2],n[2],0,-V(i,r),-V(s,r),-V(n,r),1]}function Rt(...r){if(r.length<2)return r[0];let t=r.shift(),e=Rt(...r),o=t[0],n=t[1],i=t[2],s=t[3],u=t[4],a=t[5],m=t[6],p=t[7],c=t[8],l=t[9],h=t[10],x=t[11],b=t[12],d=t[13],y=t[14],g=t[15],k=e[0],T=e[1],C=e[2],A=e[3],F=e[4],E=e[5],L=e[6],q=e[7],I=e[8],z=e[9],N=e[10],ct=e[11],ut=e[12],pt=e[13],lt=e[14],ft=e[15];return[o*k+u*T+c*C+b*A,n*k+a*T+l*C+d*A,i*k+m*T+h*C+y*A,s*k+p*T+x*C+g*A,o*F+u*E+c*L+b*q,n*F+a*E+l*L+d*q,i*F+m*E+h*L+y*q,s*F+p*E+x*L+g*q,o*I+u*z+c*N+b*ct,n*I+a*z+l*N+d*ct,i*I+m*z+h*N+y*ct,s*I+p*z+x*N+g*ct,o*ut+u*pt+c*lt+b*ft,n*ut+a*pt+l*lt+d*ft,i*ut+m*pt+h*lt+y*ft,s*ut+p*pt+x*lt+g*ft]}function Ot(r=45,t=.01,e=100){let o=1/Math.tan(r*Math.PI/360),n=e-t;return[o,0,0,0,0,o,0,0,0,0,-(e+t)/n,-1,0,0,-2*e*t/n,0]}function $t(r){let t=Math.cos(r),e=Math.sin(r);return[1,0,0,0,0,t,-e,0,0,e,t,0,0,0,0,1]}function Dt(r){let t=Math.cos(r),e=Math.sin(r);return[t,0,e,0,0,1,0,0,-e,0,t,0,0,0,0,1]}function Ht(r){let t=Math.cos(r),e=Math.sin(r);return[t,-e,0,0,e,t,0,0,0,0,1,0,0,0,0,1]}function Nt(r){return[r[0],0,0,0,0,r[1],0,0,0,0,r[2],0,0,0,0,1]}function Bt(r){return[r,0,0,0,0,r,0,0,0,0,r,0,0,0,0,1]}function Gt(r){return[1,0,0,0,0,1,0,0,0,0,1,0,r[0],r[1],r[2],1]}function Xt(r){return[r[0],r[4],r[8],r[12],r[1],r[5],r[9],r[13],r[2],r[6],r[10],r[14],r[3],r[7],r[11],r[15]]}var tr=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],R=class{elements;constructor(t=tr){this.elements=t}get transpose(){return new R(Xt(this.elements))}get determinant(){return st(this.elements)}get inverse(){return new R(qt(this.elements))}get matrix3(){return P.fromMatrix4(this)}toString(){let t=this.elements.map(e=>e.toFixed(3));return`Matrix4( ${t[0]}, ${t[4]}, ${t[8]}, ${t[12]}; ${t[1]}, ${t[5]}, ${t[9]}, ${t[13]}; ${t[2]}, ${t[6]}, ${t[10]}, ${t[14]}; ${t[3]}, ${t[7]}, ${t[11]}, ${t[15]} )`}clone(){return new R(this.elements.concat())}multiply(...t){return R.multiply(this,...t)}scaleScalar(t){return new R(w(this.elements,t))}decompose(){let{position:t,scale:e,rotation:o}=Et(this.elements);return{position:new M(t),scale:new M(e),rotation:new _(o)}}static get identity(){return new R(tr)}static multiply(...t){return t.length===0?R.identity:new R(Rt(...t.map(e=>e.elements)))}static fromQuaternion(t){return new R(X(t.elements))}static fromMatrix3(t){return new R(Lt(t.elements))}static translate(t){return new R(Gt(t.elements))}static scale(t){return new R(Nt(t.elements))}static scaleScalar(t){return new R(Bt(t))}static rotateX(t){return new R($t(t))}static rotateY(t){return new R(Dt(t))}static rotateZ(t){return new R(Ht(t))}static lookAt(t,e=new M([0,0,0]),o=new M([0,1,0]),n=0){return new R(It(t.elements,e.elements,o.elements,n))}static lookAtInverse(t,e=new M([0,0,0]),o=new M([0,1,0]),n=0){return new R(zt(t.elements,e.elements,o.elements,n))}static perspective(t=45,e=.01,o=100){return new R(Ot(t,e,o))}static compose(t,e,o){return new R(At(t.elements,e.elements,o.elements))}};function Ut(r,t){let e=t/2,o=Math.sin(e);return[r[0]*o,r[1]*o,r[2]*o,Math.cos(e)]}function rr(r,t){let{normal:e,tangent:o,binormal:n}=at(r,t??[0,1,0]),i=Math.sqrt(1+n[0]+o[1]+e[2])*.5,s=.25/i;return[(o[2]-e[1])*s,(e[0]-n[2])*s,(n[1]-o[0])*s,i]}function Yt(r){let t=S(r);return t===0?[0,0,0,1]:w(r,1/t)}function er(r,t,e){if(e===0)return r.concat();if(e===1)return t.concat();let o=V(r,t);if(o<0&&(t=G(t),o=-o),o>=1)return r.concat();let n=1-o*o;if(n<=Number.EPSILON){let m=1-e;return v([m*r[0]+e*t[0],m*r[1]+e*t[1],m*r[2]+e*t[2],m*r[3]+e*t[3]])}let i=Math.sqrt(n),s=Math.atan2(i,o),u=Math.sin((1-e)*s)/i,a=Math.sin(e*s)/i;return[r[0]*u+t[0]*a,r[1]*u+t[1]*a,r[2]*u+t[2]*a,r[3]*u+t[3]*a]}var or=[0,0,0,1],_=class{elements;constructor(t=or){this.elements=t}get x(){return this.elements[0]}get y(){return this.elements[1]}get z(){return this.elements[2]}get w(){return this.elements[3]}toString(){return`Quaternion( ${this.x.toFixed(3)}, ${this.y.toFixed(3)}, ${this.z.toFixed(3)}, ${this.w.toFixed(3)} )`}clone(){return new _(this.elements.concat())}get matrix4(){return new R(X(this.elements))}get inversed(){return new _(it(this.elements))}get length(){return S(this.elements)}get lengthSq(){return et(this.elements)}get normalized(){return new _(Yt(this.elements))}multiply(...t){return _.multiply(this,...t)}slerp(t,e){return _.slerp(this,t,e)}static get identity(){return new _(or)}static multiply(...t){return t.length===0?_.identity:new _(K(...t.map(e=>e.elements)))}static slerp(t,e,o){return new _(er(t.elements,e.elements,o))}static lookRotation(t,e){return new _(rr(t.elements,e.elements))}static fromAxisAngle(t,e){return new _(Ut(t.elements,e))}static fromMatrix4(t){return new _(mt(t.elements))}};function nr(r,t){return r-Math.floor(r/t)*t}function dt(r){return nr(r+Math.PI,2*Math.PI)-Math.PI}function j(r,t){let[e,o,n,i]=!t||t==="XYZ"?[0,1,2,1]:t==="XZY"?[0,2,1,-1]:t==="YXZ"?[1,0,2,-1]:t==="YZX"?[1,2,0,1]:t==="ZXY"?[2,0,1,1]:[2,1,0,-1],s=[0,0,0],u=r[n+e*3];return s[o]=-i*Math.asin(Mt(u,-1,1)),Math.abs(u)<.999999?(s[e]=i*Math.atan2(r[n+o*3],r[n*4]),s[n]=i*Math.atan2(r[o+e*3],r[e*4])):s[e]=i*Math.atan2(-r[o+n*3],r[o*4]),ot(s)>1.5*Math.PI&&(s[e]=dt(s[e]+Math.PI),s[o]=dt(Math.PI-s[o]),s[n]=dt(s[n]+Math.PI)),s}function ir(r,t){return j(B(r),t)}function ar(r,t){return j(rt(r),t)}function Zt(r,t){let[e,o,n,i]=!t||t==="XYZ"?[0,1,2,1]:t==="XZY"?[0,2,1,-1]:t==="YXZ"?[1,0,2,-1]:t==="YZX"?[1,2,0,1]:t==="ZXY"?[2,0,1,1]:[2,1,0,-1],s=.5*r[e],u=.5*i*r[o],a=.5*r[n],m=Math.cos(s),p=Math.cos(u),c=Math.cos(a),l=Math.sin(s),h=Math.sin(u),x=Math.sin(a),b=[0,0,0,c*p*m+x*h*l];return b[e]=c*p*l-x*h*m,b[o]=i*(c*h*m+x*p*l),b[n]=x*p*m-c*h*l,b}var W=class{elements;order;constructor(t=[0,0,0],e="XYZ"){this.elements=t,this.order=e}get x(){return this.elements[0]}get y(){return this.elements[1]}get z(){return this.elements[2]}toString(){return`Euler( ${this.x.toFixed(3)}, ${this.y.toFixed(3)}, ${this.z.toFixed(3)} (${this.order}) )`}clone(){return new W(this.elements.concat(),this.order)}get quaternion(){return new _(Zt(this.elements,this.order))}get matrix4(){return this.quaternion.matrix4}static fromMatrix3(t,e){return new W(j(t.elements,e),e)}static fromMatrix4(t,e){return new W(ir(t.elements,e),e)}static fromQuaternion(t,e){return new W(ar(t.elements,e),e)}};function br(r){return[r[0],r[4],r[8],r[1],r[5],r[9],r[2],r[6],r[10]]}var U=class extends Z{elements;constructor(t=[0,0,0,0]){super();this.elements=t}get x(){return this.elements[0]}set x(t){this.elements[0]=t}get y(){return this.elements[1]}set y(t){this.elements[1]=t}get z(){return this.elements[2]}set z(t){this.elements[2]=t}get w(){return this.elements[3]}set w(t){this.elements[3]=t}toString(){return`Vector4( ${this.x.toFixed(3)}, ${this.y.toFixed(3)}, ${this.z.toFixed(3)}, ${this.w.toFixed(3)} )`}applyMatrix4(t){return new U(nt(this.elements,t.elements))}__new(t){return new U(t)}static get zero(){return new U([0,0,0,0])}static get one(){return new U([1,1,1,1])}};var J=["2","3","4","5","6","7","8","9","T","J","Q","K","A"];var sr=["c","d","h","s"];function Aa(){let r=[];return sr.map(t=>J.map(e=>r.push(e+t))),r}var $={HighCard:0,OnePair:1,TwoPair:2,ThreeOfAKind:3,Straight:4,Flush:5,FullHouse:6,FourOfAKind:7,StraightFlush:8};var f={"2":0,"3":1,"4":2,"5":3,"6":4,"7":5,"8":6,"9":7,T:8,J:9,Q:10,K:11,A:12};var Kt={c:0,d:1,h:2,s:3};function O(r){return r.sort((t,e)=>Kt[t[1]]-Kt[e[1]]).sort((t,e)=>f[t[0]]-f[e[0]])}function Ga(r){let t=r.concat(),e=new xt,o=new xt;t.map(a=>{let m=a[0],p=a[1];e.add(m,a),o.add(p,a)});let n=[],i=[],s=[];J.map(a=>{let m=e.get(a);m.size>3?n.push(a):m.size>2?i.push(a):m.size>1&&s.push(a)});let u;{let a=[],m=Array.from(e.get("A"))[0];m&&a.push(m),J.map(p=>{let c=Array.from(e.get(p))[0];c?(a.push(c),a.length>4&&(u=a)):a=[]})}if(u){for(let[a,m]of o.map)if(m.size>0){let p,c=[],l="A"+a;if(m.has(l)&&c.push(l),J.map(x=>{let b=x+a;m.has(b)?(c.push(b),c.length>4&&(p=c)):c=[]}),p){p.splice(0,p.length-5);let x="StraightFlush",b=[$[x],f[p[4][0]]];return{hand:x,cards:p,strength:b}}}}if(n.length>0){n.sort((c,l)=>f[c]-f[l]),n.splice(0,n.length-1);let a=Array.from(e.get(n[0]));a.map(c=>t.splice(t.indexOf(c),1)),O(t).splice(0,t.length-1);let m="FourOfAKind",p=[$[m],f[n[0]],f[t[0][0]]];return t.push(...a),O(t),{hand:m,cards:t,strength:p}}if(i.length>0&&i.length+s.length>1){i.sort((c,l)=>f[c]-f[l]),s.push(...i.splice(0,i.length-1)),s.sort((c,l)=>f[c]-f[l]),s.splice(0,s.length-1);let a=Array.from(e.get(i[0]));a.push(...Array.from(e.get(s[0]))),O(a).splice(0,a.length-5);let m="FullHouse",p=[$[m],f[i[0]],f[s[0]]];return{hand:m,cards:a,strength:p}}for(let[a,m]of o.map)if(m.size>4){let p=O(Array.from(m));p.splice(0,p.length-5);let c="Flush",l=[$[c],...p.concat().reverse().map(h=>f[h[0]])];return{hand:c,cards:p,strength:l}}if(u){u.splice(0,u.length-5);let a="Straight",m=[$[a],f[u[4][0]]];return{hand:a,cards:u,strength:m}}if(i.length>0){i.sort((c,l)=>f[c]-f[l]),i.splice(0,i.length-1);let a=Array.from(e.get(i[0]));a.map(c=>t.splice(t.indexOf(c),1)),O(t).splice(0,t.length-2);let m="ThreeOfAKind",p=[$[m],f[i[0]],f[t[1][0]],f[t[0][0]]];return t.push(...a),O(t),{hand:m,cards:t,strength:p}}if(s.length>1){s.sort((c,l)=>f[c]-f[l]),s.splice(0,s.length-2);let a=Array.from(e.get(s[0]));a.push(...Array.from(e.get(s[1]))),a.map(c=>t.splice(t.indexOf(c),1)),O(t).splice(0,t.length-1);let m="TwoPair",p=[$[m],f[s[1]],f[s[0]],f[t[0][0]]];return t.push(...a),O(t),{hand:m,cards:t,strength:p}}if(s.length>0){let a=Array.from(e.get(s[0]));a.map(c=>t.splice(t.indexOf(c),1)),O(t).splice(0,t.length-3);let m="OnePair",p=[$[m],f[s[0]],f[t[2][0]],f[t[1][0]],f[t[0][0]]];return t.push(...a),O(t),{hand:m,cards:t,strength:p}}{let a="HighCard";O(t),t.splice(0,t.length-5);let m=[$[a],f[t[4][0]],f[t[3][0]],f[t[2][0]],f[t[1][0]],f[t[0][0]]];return{hand:a,cards:t,strength:m}}}var Ua=["HighCard","OnePair","TwoPair","ThreeOfAKind","Straight","Flush","FullHouse","FourOfAKind","StraightFlush"];var wr=class{i;o;constructor(t,e){this.i=t,this.o=e}swap(){let t=this.i;this.i=this.o,this.o=t}};var Rr=class{__bpm=0;__lastTap=0;__lastBeat=0;__lastTime=0;__calc=new kt(16);get beatDuration(){return 60/this.__bpm}get bpm(){return this.__bpm}set bpm(t){this.__lastBeat=this.beat,this.__lastTime=performance.now(),this.__bpm=t}get beat(){return this.__lastBeat+(performance.now()-this.__lastTime)*.001/this.beatDuration}reset(){this.__calc.reset()}nudge(t){this.__lastBeat=this.beat+t,this.__lastTime=performance.now()}tap(){let t=performance.now(),e=(t-this.__lastTap)*.001;2<e?this.reset():(this.__calc.push(e),this.__bpm=60/this.__calc.mean),this.__lastTap=t,this.__lastTime=t,this.__lastBeat=0}};var dr=class{seed;constructor(t){this.seed=t||1}gen(t){return t&&(this.seed=t),this.seed=this.seed^this.seed<<13,this.seed=this.seed^this.seed>>>17,this.seed=this.seed^this.seed<<5,this.seed/Math.pow(2,32)+.5}set(t){this.seed=t||this.seed||1}};function Mr(r,t,e=.5){if(t>=1)return r;if(t<0)return"";let o=Y(0,1-e,t),n=Y(e,1,t),i=1+Math.floor(o*(r.length-1)),s=t<e?0:1+Math.floor(n*(r.length-1)),u=i-s,a=[...Array(u)].map(()=>String.fromCharCode(33+Math.floor(93*Math.random()))).join("");return r.substring(0,s)+a}export{ur as CDS,tt as Clock,pr as ClockFrame,lr as ClockRealtime,W as Euler,hr as ExpSmooth,Wt as GPUTimer,kt as HistoryMeanCalculator,xr as HistoryMedianCalculator,Tt as HistoryPercentileCalculator,xt as MapOfSet,P as Matrix3,R as Matrix4,gt as Pool,_ as Quaternion,wr as Swap,Pr as TRIANGLE_STRIP_QUAD,vr as TRIANGLE_STRIP_QUAD_3D,Vr as TRIANGLE_STRIP_QUAD_NORMAL,Sr as TRIANGLE_STRIP_QUAD_UV,Rr as TapTempo,Z as Vector,M as Vector3,U as Vector4,dr as Xorshift,yr as arraySetAdd,mr as arraySetDelete,kr as arraySetDiff,cr as arraySetHas,gr as arraySetUnion,ht as binarySearch,Mt as clamp,Yr as colorToHex,Aa as createPokerDeck,yt as edt1d,fr as edt2d,Kr as eotfRec709,j as eulerFromMat3,ir as eulerFromMat4,ar as eulerFromQuaternion,Ga as evaluatePokerHand,Mr as getYugopText,jt as lerp,Y as linearstep,Pt as mat3Determinant,B as mat3FromMat4,br as mat3FromMat4Transpose,rt as mat3FromQuaternion,vt as mat3Inverse,bt as mat3Multiply,Vt as mat3Transpose,At as mat4Compose,Et as mat4Decompose,st as mat4Determinant,Lt as mat4FromMat3,X as mat4FromQuaternion,qt as mat4Inverse,It as mat4LookAt,zt as mat4LookAtInverse,Rt as mat4Multiply,Ot as mat4Perspective,$t as mat4RotateX,Dt as mat4RotateY,Ht as mat4RotateZ,Nt as mat4Scale,Bt as mat4ScaleScalar,Gt as mat4Translate,Xt as mat4Transpose,Fr as matrix2d,Er as matrix3d,nr as mod,Wr as oetfRec709,$ as pokerHandStrengthMap,Ua as pokerHandsByStrength,f as pokerRankStrengthMap,J as pokerRanksByStrength,Kt as pokerSuitIndexMap,sr as pokerSuitsByIndex,Ut as quatFromAxisAngle,Zt as quatFromEuler,Ft as quatFromMatrix3,mt as quatFromMatrix4,it as quatInverse,K as quatMultiply,Yt as quatNormalize,Hr as range,dt as sanitizeAngle,_t as saturate,Cr as shuffleArray,Br as smootherstep,Gr as smootheststep,Nr as smoothstep,O as sortPokerCardsByRank,Ar as triIndexToLineIndex,Qt as vec3ApplyMatrix4,Ct as vec3ApplyQuaternion,Q as vec3Cross,at as vec3OrthoNormalize,nt as vec4ApplyMatrix4,H as vecAdd,St as vecDivide,V as vecDot,S as vecLength,et as vecLengthSq,ot as vecManhattanLength,wt as vecMultiply,G as vecNeg,v as vecNormalize,w as vecScale,D as vecSub};
//# sourceMappingURL=0b5vr-experimental.next.min.js.map
