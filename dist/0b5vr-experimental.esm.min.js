// (c) 2019-2022 0b5vr - https://github.com/0b5vr/experimental-npm/blob/release/LICENSE
var ht=(r,t,e)=>new Promise((o,n)=>{var a=i=>{try{u(e.next(i))}catch(m){n(m)}},s=i=>{try{u(e.throw(i))}catch(m){n(m)}},u=i=>i.done?o(i.value):Promise.resolve(i.value).then(a,s);u((e=e.apply(r,t)).next())});function xt(r,t){if(typeof t!="function")return xt(r,a=>a<t);let e=t,o=0,n=r.length;for(;o<n;){let a=o+n>>1,s=r[a];e(s)?o=a+1:n=a}return o}function cr(r,t){let e=r.indexOf(t);return e===-1?!1:(r.splice(e,1),!0)}function ur(r,t){return r.indexOf(t)!==-1}function kr(r,t){return r.indexOf(t)!==-1?!1:(r.push(t),!0)}function Tr(r,t){let e=[...r];return t.forEach(o=>{ur(e,o)||e.push(o)}),e}function Pr(r,t){let e=[...r];return t.forEach(o=>{cr(e,o)}),e}var Vr=[-1,-1,1,-1,-1,1,1,1],Sr=[-1,-1,0,1,-1,0,-1,1,0,1,1,0],Qr=[0,0,1,0,0,1,0,0,1,0,0,1],Cr=[0,0,1,0,0,1,1,1];function Fr(r,t){let e=t||(()=>Math.random());for(let o=0;o<r.length-1;o++){let n=o+Math.floor(e()*(r.length-o)),a=r[n];r[n]=r[o],r[o]=a}return r}function Er(r){let t=[];for(let e=0;e<r.length/3;e++){let o=e*3;t.push(r[o],r[o+1],r[o+1],r[o+2],r[o+2],r[o])}return t}function Lr(r,t){let e=[];for(let o=0;o<t;o++)for(let n=0;n<r;n++)e.push(n,o);return e}function qr(r,t,e){let o=[];for(let n=0;n<e;n++)for(let a=0;a<t;a++)for(let s=0;s<r;s++)o.push(s,a,n);return o}var pr=class{constructor(){this.factor=100;this.ratio=1;this.velocity=0;this.value=0;this.target=0}update(t){return this.velocity+=(-this.factor*(this.value-this.target)-2*this.velocity*Math.sqrt(this.factor)*this.ratio)*t,this.value+=this.velocity*t,this.value}};var tt=class{constructor(){this.__time=0;this.__deltaTime=0;this.__isPlaying=!1}get time(){return this.__time}get deltaTime(){return this.__deltaTime}get isPlaying(){return this.__isPlaying}update(t){let e=this.__time;this.__time=t||0,this.__deltaTime=this.__time-e}play(){this.__isPlaying=!0}pause(){this.__isPlaying=!1}setTime(t){this.__time=t}};var lr=class extends tt{constructor(t=60){super();this.__frame=0;this.__fps=t}get frame(){return this.__frame}get fps(){return this.__fps}update(){this.__isPlaying?(this.__time=this.__frame/this.__fps,this.__deltaTime=1/this.__fps,this.__frame++):this.__deltaTime=0}setTime(t){this.__frame=Math.floor(this.__fps*t),this.__time=this.__frame/this.__fps}};var fr=class extends tt{constructor(){super(...arguments);this.__rtTime=0;this.__rtDate=performance.now()}get isRealtime(){return!0}update(){let t=performance.now();if(this.__isPlaying){let e=this.__time,o=t-this.__rtDate;this.__time=this.__rtTime+o/1e3,this.__deltaTime=this.time-e}else this.__rtTime=this.time,this.__rtDate=t,this.__deltaTime=0}setTime(t){this.__time=t,this.__rtTime=this.time,this.__rtDate=performance.now()}};function Wt(r,t,e){return r+(t-r)*e}function _t(r,t,e){return Math.min(Math.max(r,t),e)}function yt(r){return _t(r,0,1)}function Br(r,t,e,o,n){return(r-t)*(n-o)/(e-t)+o}function Y(r,t,e){return yt((e-r)/(t-r))}function Gr(r,t,e){let o=Y(r,t,e);return o*o*(3-2*o)}function Xr(r,t,e){let o=Y(r,t,e);return o*o*o*(o*(o*6-15)+10)}function Ur(r,t,e){let o=Y(r,t,e);return o*o*o*o*(o*(o*(-20*o+70)-84)+35)}function Kr(r){return"#"+r.map(t=>("0"+Math.round(yt(t)*255).toString(16)).slice(-2)).join("")}function Wr(r){return r.map(t=>t<.081?t/4.5:Math.pow((t+.099)/1.099,1/.45))}function te(r){return r.map(t=>t<.018?4.5*t:1.099*Math.pow(t,.45)-.099)}function gt(r,t,e,o){let n=0,a=new Float32Array(o);a[0]=0;let s=new Float32Array(o+1);s[0]=-1/0,s[1]=1/0;let u=new Float32Array(o);for(let i=0;i<o;i++)u[i]=r[t+i*e];for(let i=1;i<o;i++){let m=0;for(;0<=n&&(m=(u[i]+i*i-u[a[n]]-a[n]*a[n])/(2*i-2*a[n]),m<=s[n]);)n--;n++,a[n]=i,s[n]=m,s[n+1]=1/0}n=0;for(let i=0;i<o;i++){for(;s[n+1]<i;)n++;let m=i-a[n];r[t+i*e]=u[a[n]]+m*m}}function hr(r,t,e){for(let o=0;o<t;o++)gt(r,o,t,e);for(let o=0;o<e;o++)gt(r,o*t,1,t)}var xr=class{constructor(){this.factor=10;this.target=0;this.value=0}update(t){return this.value=Wt(this.target,this.value,Math.exp(-this.factor*t)),this.value}};var kt=class{constructor(t){this.index=0;this.array=t}get current(){return this.array[this.index]}next(){return this.index=(this.index+1)%this.array.length,this.current}};var Jt=class{static isSupported(t){return new Set(t.getSupportedExtensions()).has("EXT_disjoint_timer_query_webgl2")}constructor(t){this.gl=t;let e=new Array(1024).fill(1).map(()=>t.createQuery());this.queries=new kt(e),this.stack=[],this.ext=t.getExtension("EXT_disjoint_timer_query_webgl2"),this.__loopTasks=new Set;let o=()=>{this.update(),requestAnimationFrame(o)};o()}update(){Array.from(this.__loopTasks).forEach(t=>t())}measure(t){return ht(this,null,function*(){let{gl:e}=this;if(this.stack.length!==0){e.endQuery(this.ext.TIME_ELAPSED_EXT);let a=this.check(this.queries.current);this.stack=this.stack.map(s=>ht(this,null,function*(){return(yield s)+(yield a)}))}this.stack.push(Promise.resolve(0)),e.beginQuery(this.ext.TIME_ELAPSED_EXT,this.queries.next()),t(),e.endQuery(this.ext.TIME_ELAPSED_EXT);let o=this.stack.pop(),n=this.check(this.queries.current);return this.stack.length!==0&&(this.stack=this.stack.map(a=>ht(this,null,function*(){return(yield a)+(yield n)})),e.beginQuery(this.ext.TIME_ELAPSED_EXT,this.queries.next())),(yield o)+(yield n)})}check(t){let{gl:e}=this;return new Promise(o=>{let n=()=>{e.getQueryParameter(t,e.QUERY_RESULT_AVAILABLE)&&(this.__loopTasks.delete(n),o(e.getQueryParameter(t,e.QUERY_RESULT)*.001*.001))};this.__loopTasks.add(n)})}};var Tt=class{constructor(t){this.__recalcForEach=0;this.__countUntilRecalc=0;this.__history=[];this.__index=0;this.__count=0;this.__cache=0;this.__length=t,this.__recalcForEach=t;for(let e=0;e<t;e++)this.__history[e]=0}get mean(){let t=Math.min(this.__count,this.__length);return t===0?0:this.__cache/t}get recalcForEach(){return this.__recalcForEach}set recalcForEach(t){let e=t-this.__recalcForEach;this.__recalcForEach=t,this.__countUntilRecalc=Math.max(0,this.__countUntilRecalc+e)}reset(){this.__index=0,this.__count=0,this.__cache=0,this.__countUntilRecalc=0;for(let t=0;t<this.__length;t++)this.__history[t]=0}push(t){let e=this.__history[this.__index];this.__history[this.__index]=t,this.__count++,this.__index=(this.__index+1)%this.__length,this.__countUntilRecalc===0?this.recalc():(this.__countUntilRecalc--,this.__cache-=e,this.__cache+=t)}recalc(){this.__countUntilRecalc=this.__recalcForEach;let t=this.__history.slice(0,Math.min(this.__count,this.__length)).reduce((e,o)=>e+o,0);this.__cache=t}};var Pt=class{constructor(t){this.__history=[];this.__sorted=[];this.__index=0;this.__length=t}get median(){return this.percentile(50)}percentile(t){return this.__history.length===0?0:this.__sorted[Math.round(t*.01*(this.__history.length-1))]}reset(){this.__index=0,this.__history=[],this.__sorted=[]}push(t){let e=this.__history[this.__index];if(this.__history[this.__index]=t,this.__index=(this.__index+1)%this.__length,this.__sorted.length===this.__length){let n=xt(this.__sorted,e);this.__sorted.splice(n,1)}let o=xt(this.__sorted,t);this.__sorted.splice(o,0,t)}};var br=class extends Pt{constructor(t){super(t);console.warn("HistoryMedianCalculator: Deprecated. Use HistoryPercentileCalculator instead")}};var bt=class{constructor(){this.map=new Map}get(t){var e;return(e=this.map.get(t))!=null?e:new Set}add(t,e){let o=this.map.get(t);o==null&&(o=new Set,this.map.set(t,o)),o.add(e)}};function vt(r){let t=r[0],e=r[1],o=r[2],n=r[3],a=r[4],s=r[5],u=r[6],i=r[7],m=r[8],p=m*a-s*i,c=s*u-m*n,l=i*n-a*u;return t*p+e*c+o*l}function B(r){return[r[0],r[1],r[2],r[4],r[5],r[6],r[8],r[9],r[10]]}function rt(r){let t=r[0],e=r[1],o=r[2],n=r[3];return[1-2*e*e-2*o*o,2*t*e+2*o*n,2*t*o-2*e*n,2*t*e-2*o*n,1-2*t*t-2*o*o,2*e*o+2*t*n,2*t*o+2*e*n,2*e*o-2*t*n,1-2*t*t-2*e*e]}function w(r,t){return r.map(e=>e*t)}function Vt(r){let t=r[0],e=r[1],o=r[2],n=r[3],a=r[4],s=r[5],u=r[6],i=r[7],m=r[8],p=m*a-s*i,c=s*u-m*n,l=i*n-a*u,h=t*p+e*c+o*l;return h===0?w(r,0):w([p,o*i-m*e,s*e-o*a,c,m*t-o*u,o*n-s*t,l,e*u-i*t,a*t-e*n],1/h)}function wt(...r){if(r.length<2)return r[0];let t=r.shift(),e=wt(...r),o=t[0],n=t[1],a=t[2],s=t[3],u=t[4],i=t[5],m=t[6],p=t[7],c=t[8],l=e[0],h=e[1],x=e[2],b=e[3],d=e[4],y=e[5],g=e[6],k=e[7],T=e[8];return[o*l+s*h+m*x,n*l+u*h+p*x,a*l+i*h+c*x,o*b+s*d+m*y,n*b+u*d+p*y,a*b+i*d+c*y,o*g+s*k+m*T,n*g+u*k+p*T,a*g+i*k+c*T]}function St(r){return[r[0],r[3],r[6],r[1],r[4],r[7],r[2],r[5],r[8]]}var tr=[1,0,0,0,1,0,0,0,1],P=class{constructor(t=tr){this.elements=t}get transpose(){return new P(St(this.elements))}get determinant(){return vt(this.elements)}get inverse(){return new P(Vt(this.elements))}get matrix4(){return R.fromMatrix3(this)}toString(){let t=this.elements.map(e=>e.toFixed(3));return`Matrix3( ${t[0]}, ${t[3]}, ${t[6]}; ${t[1]}, ${t[4]}, ${t[7]}; ${t[2]}, ${t[5]}, ${t[8]} )`}clone(){return new P(this.elements.concat())}multiply(...t){return P.multiply(this,...t)}scaleScalar(t){return new P(w(this.elements,t))}static get identity(){return new P(tr)}static multiply(...t){return t.length===0?P.identity:new P(wt(...t.map(e=>e.elements)))}static fromMatrix4(t){return new P(B(t.elements))}static fromQuaternion(t){return new P(rt(t.elements))}};function H(...r){if(r.length<2)return r[0];let t=r.shift(),e=H(...r);return t.map((o,n)=>o+e[n])}function Qt(r,t){return r.map((e,o)=>e/t[o])}function V(r,t){return r.reduce((e,o,n)=>e+o*t[n],0)}function S(r){return Math.sqrt(r.reduce((t,e)=>t+e*e,0))}function et(r){return r.reduce((t,e)=>t+e*e,0)}function ot(r){return r.reduce((t,e)=>t+Math.abs(e),0)}function Rt(...r){if(r.length<2)return r[0];let t=r.shift(),e=Rt(...r);return t.map((o,n)=>o*e[n])}function G(r){return r.map(t=>-t)}function v(r){let t=S(r),e=t===0?0:1/t;return w(r,e)}function D(r,t){return r.map((e,o)=>e-t[o])}var Z=class{get length(){return S(this.elements)}get lengthSq(){return et(this.elements)}get manhattanLength(){return ot(this.elements)}get normalized(){return this.__new(v(this.elements))}get negated(){return this.__new(G(this.elements))}clone(){return this.__new(this.elements.concat())}add(...t){return this.__new(H(this.elements,...t.map(e=>e.elements)))}sub(t){return this.__new(D(this.elements,t.elements))}multiply(...t){return this.__new(Rt(this.elements,...t.map(e=>e.elements)))}divide(t){return this.__new(Qt(this.elements,t.elements))}scale(t){return this.__new(w(this.elements,t))}dot(t){return V(this.elements,t.elements)}};function nt(r,t){return[t[0]*r[0]+t[4]*r[1]+t[8]*r[2]+t[12]*r[3],t[1]*r[0]+t[5]*r[1]+t[9]*r[2]+t[13]*r[3],t[2]*r[0]+t[6]*r[1]+t[10]*r[2]+t[14]*r[3],t[3]*r[0]+t[7]*r[1]+t[11]*r[2]+t[15]*r[3]]}function Ct(r,t){let e=nt([...r,1],t),o=[e[0],e[1],e[2]],n=e[3];return w(o,1/n)}function it(r){return[-r[0],-r[1],-r[2],r[3]]}function K(...r){if(r.length<2)return r[0];let t=r.shift(),e=K(...r);return[t[3]*e[0]+t[0]*e[3]+t[1]*e[2]-t[2]*e[1],t[3]*e[1]-t[0]*e[2]+t[1]*e[3]+t[2]*e[0],t[3]*e[2]+t[0]*e[1]-t[1]*e[0]+t[2]*e[3],t[3]*e[3]-t[0]*e[0]-t[1]*e[1]-t[2]*e[2]]}function At(r,t){let e=[...r,0],o=it(t),n=K(t,e,o);return n.pop(),n}function Q(r,t){return[r[1]*t[2]-r[2]*t[1],r[2]*t[0]-r[0]*t[2],r[0]*t[1]-r[1]*t[0]]}function at(r,t=[0,1,0],e){let o=v(r),n=v(t),a=V(o,n);a===1&&(Math.abs(o[1])>Math.abs(o[2])?n=[0,0,1]:n=[0,1,0],a=V(o,n)),n=v(D(n,w(o,a)));let s=Q(n,o);return e&&V(s,e)<0&&(s=G(s)),{normal:o,tangent:n,binormal:s}}var M=class extends Z{constructor(t=[0,0,0]){super();this.elements=t}get x(){return this.elements[0]}set x(t){this.elements[0]=t}get y(){return this.elements[1]}set y(t){this.elements[1]=t}get z(){return this.elements[2]}set z(t){this.elements[2]=t}toString(){return`Vector3( ${this.x.toFixed(3)}, ${this.y.toFixed(3)}, ${this.z.toFixed(3)} )`}cross(t){return new M(Q(this.elements,t.elements))}applyQuaternion(t){return new M(At(this.elements,t.elements))}applyMatrix4(t){return new M(Ct(this.elements,t.elements))}__new(t){return new M(t)}static get zero(){return new M([0,0,0])}static get one(){return new M([1,1,1])}static orthoNormalize(t,e,o){let n=at(t.elements,e.elements,o.elements);return{normal:new M(n.normal),tangent:new M(n.tangent),binormal:new M(n.binormal)}}};function X(r){let t=r[0],e=r[1],o=r[2],n=r[3];return[1-2*e*e-2*o*o,2*t*e+2*o*n,2*t*o-2*e*n,0,2*t*e-2*o*n,1-2*t*t-2*o*o,2*e*o+2*t*n,0,2*t*o+2*e*n,2*e*o-2*t*n,1-2*t*t-2*e*e,0,0,0,0,1]}function Ft(r,t,e){let o=X(t),n=e[0],a=e[1],s=e[2];return[o[0]*n,o[1]*n,o[2]*n,0,o[4]*a,o[5]*a,o[6]*a,0,o[8]*s,o[9]*s,o[10]*s,0,r[0],r[1],r[2],1]}function st(r){let t=r[0],e=r[1],o=r[2],n=r[3],a=r[4],s=r[5],u=r[6],i=r[7],m=r[8],p=r[9],c=r[10],l=r[11],h=r[12],x=r[13],b=r[14],d=r[15],y=t*s-e*a,g=t*u-o*a,k=t*i-n*a,T=e*u-o*s,C=e*i-n*s,A=o*i-n*u,F=m*x-p*h,E=m*b-c*h,L=m*d-l*h,q=p*b-c*x,I=p*d-l*x,z=c*d-l*b;return y*z-g*I+k*q+T*L-C*E+A*F}function Et(r){let t=r[0],e=r[3],o=r[6],n=r[1],a=r[4],s=r[7],u=r[2],i=r[5],m=r[8],p=t+a+m;if(p>0){let c=.5/Math.sqrt(p+1);return[(i-s)*c,(o-u)*c,(n-e)*c,.25/c]}else if(t>a&&t>m){let c=2*Math.sqrt(1+t-a-m);return[.25*c,(e+n)/c,(o+u)/c,(i-s)/c]}else if(a>m){let c=2*Math.sqrt(1+a-t-m);return[(e+n)/c,.25*c,(s+i)/c,(o-u)/c]}else{let c=2*Math.sqrt(1+m-t-a);return[(o+u)/c,(s+i)/c,.25*c,(n-e)/c]}}function mt(r){return Et(B(r))}function Lt(r){let t=S([r[0],r[1],r[2]]),e=S([r[4],r[5],r[6]]),o=S([r[8],r[9],r[10]]);st(r)<0&&(t=-t);let a=1/t,s=1/e,u=1/o,i=r.concat();return i[0]*=a,i[1]*=a,i[2]*=a,i[4]*=s,i[5]*=s,i[6]*=s,i[8]*=u,i[9]*=u,i[10]*=u,{position:[r[12],r[13],r[14]],scale:[t,e,o],rotation:mt(i)}}function qt(r){return[r[0],r[1],r[2],0,r[3],r[4],r[5],0,r[6],r[7],r[8],0,0,0,0,1]}function It(r){let t=r[0],e=r[1],o=r[2],n=r[3],a=r[4],s=r[5],u=r[6],i=r[7],m=r[8],p=r[9],c=r[10],l=r[11],h=r[12],x=r[13],b=r[14],d=r[15],y=t*s-e*a,g=t*u-o*a,k=t*i-n*a,T=e*u-o*s,C=e*i-n*s,A=o*i-n*u,F=m*x-p*h,E=m*b-c*h,L=m*d-l*h,q=p*b-c*x,I=p*d-l*x,z=c*d-l*b,N=y*z-g*I+k*q+T*L-C*E+A*F;return N===0?w(r,0):w([s*z-u*I+i*q,o*I-e*z-n*q,x*A-b*C+d*T,c*C-p*A-l*T,u*L-a*z-i*E,t*z-o*L+n*E,b*k-h*A-d*g,m*A-c*k+l*g,a*I-s*L+i*F,e*L-t*I-n*F,h*C-x*k+d*y,p*k-m*C-l*y,s*E-a*q-u*F,t*q-e*E+o*F,x*g-h*T-b*y,m*T-p*g+c*y],1/N)}function zt(r,t=[0,0,0],e=[0,1,0],o=0){let n=v(D(r,t)),a=v(Q(e,n));o!==0&&(a=H(w(a,Math.cos(o)),w(Q(n,a),Math.sin(o))));let s=Q(n,a);return[a[0],a[1],a[2],0,s[0],s[1],s[2],0,n[0],n[1],n[2],0,r[0],r[1],r[2],1]}function Ot(r,t=[0,0,0],e=[0,1,0],o=0){let n=v(D(r,t)),a=v(Q(e,n));o!==0&&(a=H(w(a,Math.cos(o)),w(Q(n,a),Math.sin(o))));let s=Q(n,a);return[a[0],s[0],n[0],0,a[1],s[1],n[1],0,a[2],s[2],n[2],0,-V(a,r),-V(s,r),-V(n,r),1]}function dt(...r){if(r.length<2)return r[0];let t=r.shift(),e=dt(...r),o=t[0],n=t[1],a=t[2],s=t[3],u=t[4],i=t[5],m=t[6],p=t[7],c=t[8],l=t[9],h=t[10],x=t[11],b=t[12],d=t[13],y=t[14],g=t[15],k=e[0],T=e[1],C=e[2],A=e[3],F=e[4],E=e[5],L=e[6],q=e[7],I=e[8],z=e[9],N=e[10],ct=e[11],ut=e[12],pt=e[13],lt=e[14],ft=e[15];return[o*k+u*T+c*C+b*A,n*k+i*T+l*C+d*A,a*k+m*T+h*C+y*A,s*k+p*T+x*C+g*A,o*F+u*E+c*L+b*q,n*F+i*E+l*L+d*q,a*F+m*E+h*L+y*q,s*F+p*E+x*L+g*q,o*I+u*z+c*N+b*ct,n*I+i*z+l*N+d*ct,a*I+m*z+h*N+y*ct,s*I+p*z+x*N+g*ct,o*ut+u*pt+c*lt+b*ft,n*ut+i*pt+l*lt+d*ft,a*ut+m*pt+h*lt+y*ft,s*ut+p*pt+x*lt+g*ft]}function $t(r=45,t=.01,e=100){let o=1/Math.tan(r*Math.PI/360),n=e-t;return[o,0,0,0,0,o,0,0,0,0,-(e+t)/n,-1,0,0,-2*e*t/n,0]}function Dt(r){let t=Math.cos(r),e=Math.sin(r);return[1,0,0,0,0,t,-e,0,0,e,t,0,0,0,0,1]}function Ht(r){let t=Math.cos(r),e=Math.sin(r);return[t,0,e,0,0,1,0,0,-e,0,t,0,0,0,0,1]}function Nt(r){let t=Math.cos(r),e=Math.sin(r);return[t,-e,0,0,e,t,0,0,0,0,1,0,0,0,0,1]}function Bt(r){return[r[0],0,0,0,0,r[1],0,0,0,0,r[2],0,0,0,0,1]}function Gt(r){return[r,0,0,0,0,r,0,0,0,0,r,0,0,0,0,1]}function Xt(r){return[1,0,0,0,0,1,0,0,0,0,1,0,r[0],r[1],r[2],1]}function Ut(r){return[r[0],r[4],r[8],r[12],r[1],r[5],r[9],r[13],r[2],r[6],r[10],r[14],r[3],r[7],r[11],r[15]]}var rr=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],R=class{constructor(t=rr){this.elements=t}get transpose(){return new R(Ut(this.elements))}get determinant(){return st(this.elements)}get inverse(){return new R(It(this.elements))}get matrix3(){return P.fromMatrix4(this)}toString(){let t=this.elements.map(e=>e.toFixed(3));return`Matrix4( ${t[0]}, ${t[4]}, ${t[8]}, ${t[12]}; ${t[1]}, ${t[5]}, ${t[9]}, ${t[13]}; ${t[2]}, ${t[6]}, ${t[10]}, ${t[14]}; ${t[3]}, ${t[7]}, ${t[11]}, ${t[15]} )`}clone(){return new R(this.elements.concat())}multiply(...t){return R.multiply(this,...t)}scaleScalar(t){return new R(w(this.elements,t))}decompose(){let{position:t,scale:e,rotation:o}=Lt(this.elements);return{position:new M(t),scale:new M(e),rotation:new _(o)}}static get identity(){return new R(rr)}static multiply(...t){return t.length===0?R.identity:new R(dt(...t.map(e=>e.elements)))}static fromQuaternion(t){return new R(X(t.elements))}static fromMatrix3(t){return new R(qt(t.elements))}static translate(t){return new R(Xt(t.elements))}static scale(t){return new R(Bt(t.elements))}static scaleScalar(t){return new R(Gt(t))}static rotateX(t){return new R(Dt(t))}static rotateY(t){return new R(Ht(t))}static rotateZ(t){return new R(Nt(t))}static lookAt(t,e=new M([0,0,0]),o=new M([0,1,0]),n=0){return new R(zt(t.elements,e.elements,o.elements,n))}static lookAtInverse(t,e=new M([0,0,0]),o=new M([0,1,0]),n=0){return new R(Ot(t.elements,e.elements,o.elements,n))}static perspective(t=45,e=.01,o=100){return new R($t(t,e,o))}static compose(t,e,o){return new R(Ft(t.elements,e.elements,o.elements))}};function Yt(r,t){let e=t/2,o=Math.sin(e);return[r[0]*o,r[1]*o,r[2]*o,Math.cos(e)]}function er(r,t){let{normal:e,tangent:o,binormal:n}=at(r,t!=null?t:[0,1,0]),a=Math.sqrt(1+n[0]+o[1]+e[2])*.5,s=.25/a;return[(o[2]-e[1])*s,(e[0]-n[2])*s,(n[1]-o[0])*s,a]}function Zt(r){let t=S(r);return t===0?[0,0,0,1]:w(r,1/t)}function or(r,t,e){if(e===0)return r.concat();if(e===1)return t.concat();let o=V(r,t);if(o<0&&(t=G(t),o=-o),o>=1)return r.concat();let n=1-o*o;if(n<=Number.EPSILON){let m=1-e;return v([m*r[0]+e*t[0],m*r[1]+e*t[1],m*r[2]+e*t[2],m*r[3]+e*t[3]])}let a=Math.sqrt(n),s=Math.atan2(a,o),u=Math.sin((1-e)*s)/a,i=Math.sin(e*s)/a;return[r[0]*u+t[0]*i,r[1]*u+t[1]*i,r[2]*u+t[2]*i,r[3]*u+t[3]*i]}var nr=[0,0,0,1],_=class{constructor(t=nr){this.elements=t}get x(){return this.elements[0]}get y(){return this.elements[1]}get z(){return this.elements[2]}get w(){return this.elements[3]}toString(){return`Quaternion( ${this.x.toFixed(3)}, ${this.y.toFixed(3)}, ${this.z.toFixed(3)}, ${this.w.toFixed(3)} )`}clone(){return new _(this.elements.concat())}get matrix4(){return new R(X(this.elements))}get inversed(){return new _(it(this.elements))}get length(){return S(this.elements)}get lengthSq(){return et(this.elements)}get normalized(){return new _(Zt(this.elements))}multiply(...t){return _.multiply(this,...t)}slerp(t,e){return _.slerp(this,t,e)}static get identity(){return new _(nr)}static multiply(...t){return t.length===0?_.identity:new _(K(...t.map(e=>e.elements)))}static slerp(t,e,o){return new _(or(t.elements,e.elements,o))}static lookRotation(t,e){return new _(er(t.elements,e.elements))}static fromAxisAngle(t,e){return new _(Yt(t.elements,e))}static fromMatrix4(t){return new _(mt(t.elements))}};function ir(r,t){return r-Math.floor(r/t)*t}function Mt(r){return ir(r+Math.PI,2*Math.PI)-Math.PI}function j(r,t){let[e,o,n,a]=!t||t==="XYZ"?[0,1,2,1]:t==="XZY"?[0,2,1,-1]:t==="YXZ"?[1,0,2,-1]:t==="YZX"?[1,2,0,1]:t==="ZXY"?[2,0,1,1]:[2,1,0,-1],s=[0,0,0],u=r[n+e*3];return s[o]=-a*Math.asin(_t(u,-1,1)),Math.abs(u)<.999999?(s[e]=a*Math.atan2(r[n+o*3],r[n*4]),s[n]=a*Math.atan2(r[o+e*3],r[e*4])):s[e]=a*Math.atan2(-r[o+n*3],r[o*4]),ot(s)>1.5*Math.PI&&(s[e]=Mt(s[e]+Math.PI),s[o]=Mt(Math.PI-s[o]),s[n]=Mt(s[n]+Math.PI)),s}function ar(r,t){return j(B(r),t)}function sr(r,t){return j(rt(r),t)}function Kt(r,t){let[e,o,n,a]=!t||t==="XYZ"?[0,1,2,1]:t==="XZY"?[0,2,1,-1]:t==="YXZ"?[1,0,2,-1]:t==="YZX"?[1,2,0,1]:t==="ZXY"?[2,0,1,1]:[2,1,0,-1],s=.5*r[e],u=.5*a*r[o],i=.5*r[n],m=Math.cos(s),p=Math.cos(u),c=Math.cos(i),l=Math.sin(s),h=Math.sin(u),x=Math.sin(i),b=[0,0,0,c*p*m+x*h*l];return b[e]=c*p*l-x*h*m,b[o]=a*(c*h*m+x*p*l),b[n]=x*p*m-c*h*l,b}var W=class{constructor(t=[0,0,0],e="XYZ"){this.elements=t,this.order=e}get x(){return this.elements[0]}get y(){return this.elements[1]}get z(){return this.elements[2]}toString(){return`Euler( ${this.x.toFixed(3)}, ${this.y.toFixed(3)}, ${this.z.toFixed(3)} (${this.order}) )`}clone(){return new W(this.elements.concat(),this.order)}get quaternion(){return new _(Kt(this.elements,this.order))}get matrix4(){return this.quaternion.matrix4}static fromMatrix3(t,e){return new W(j(t.elements,e),e)}static fromMatrix4(t,e){return new W(ar(t.elements,e),e)}static fromQuaternion(t,e){return new W(sr(t.elements,e),e)}};function wr(r){return[r[0],r[4],r[8],r[1],r[5],r[9],r[2],r[6],r[10]]}var U=class extends Z{constructor(t=[0,0,0,0]){super();this.elements=t}get x(){return this.elements[0]}set x(t){this.elements[0]=t}get y(){return this.elements[1]}set y(t){this.elements[1]=t}get z(){return this.elements[2]}set z(t){this.elements[2]=t}get w(){return this.elements[3]}set w(t){this.elements[3]=t}toString(){return`Vector4( ${this.x.toFixed(3)}, ${this.y.toFixed(3)}, ${this.z.toFixed(3)}, ${this.w.toFixed(3)} )`}applyMatrix4(t){return new U(nt(this.elements,t.elements))}__new(t){return new U(t)}static get zero(){return new U([0,0,0,0])}static get one(){return new U([1,1,1,1])}};var J=["2","3","4","5","6","7","8","9","T","J","Q","K","A"];var mr=["c","d","h","s"];function Ea(){let r=[];return mr.map(t=>J.map(e=>r.push(e+t))),r}var $={HighCard:0,OnePair:1,TwoPair:2,ThreeOfAKind:3,Straight:4,Flush:5,FullHouse:6,FourOfAKind:7,StraightFlush:8};var f={"2":0,"3":1,"4":2,"5":3,"6":4,"7":5,"8":6,"9":7,T:8,J:9,Q:10,K:11,A:12};var jt={c:0,d:1,h:2,s:3};function O(r){return r.sort((t,e)=>jt[t[1]]-jt[e[1]]).sort((t,e)=>f[t[0]]-f[e[0]])}function Ua(r){let t=r.concat(),e=new bt,o=new bt;t.map(i=>{let m=i[0],p=i[1];e.add(m,i),o.add(p,i)});let n=[],a=[],s=[];J.map(i=>{let m=e.get(i);m.size>3?n.push(i):m.size>2?a.push(i):m.size>1&&s.push(i)});let u;{let i=[],m=Array.from(e.get("A"))[0];m&&i.push(m),J.map(p=>{let c=Array.from(e.get(p))[0];c?(i.push(c),i.length>4&&(u=i)):i=[]})}if(u){for(let[i,m]of o.map)if(m.size>0){let p,c=[],l="A"+i;if(m.has(l)&&c.push(l),J.map(x=>{let b=x+i;m.has(b)?(c.push(b),c.length>4&&(p=c)):c=[]}),p){p.splice(0,p.length-5);let x="StraightFlush",b=[$[x],f[p[4][0]]];return{hand:x,cards:p,strength:b}}}}if(n.length>0){n.sort((c,l)=>f[c]-f[l]),n.splice(0,n.length-1);let i=Array.from(e.get(n[0]));i.map(c=>t.splice(t.indexOf(c),1)),O(t).splice(0,t.length-1);let m="FourOfAKind",p=[$[m],f[n[0]],f[t[0][0]]];return t.push(...i),O(t),{hand:m,cards:t,strength:p}}if(a.length>0&&a.length+s.length>1){a.sort((c,l)=>f[c]-f[l]),s.push(...a.splice(0,a.length-1)),s.sort((c,l)=>f[c]-f[l]),s.splice(0,s.length-1);let i=Array.from(e.get(a[0]));i.push(...Array.from(e.get(s[0]))),O(i).splice(0,i.length-5);let m="FullHouse",p=[$[m],f[a[0]],f[s[0]]];return{hand:m,cards:i,strength:p}}for(let[i,m]of o.map)if(m.size>4){let p=O(Array.from(m));p.splice(0,p.length-5);let c="Flush",l=[$[c],...p.concat().reverse().map(h=>f[h[0]])];return{hand:c,cards:p,strength:l}}if(u){u.splice(0,u.length-5);let i="Straight",m=[$[i],f[u[4][0]]];return{hand:i,cards:u,strength:m}}if(a.length>0){a.sort((c,l)=>f[c]-f[l]),a.splice(0,a.length-1);let i=Array.from(e.get(a[0]));i.map(c=>t.splice(t.indexOf(c),1)),O(t).splice(0,t.length-2);let m="ThreeOfAKind",p=[$[m],f[a[0]],f[t[1][0]],f[t[0][0]]];return t.push(...i),O(t),{hand:m,cards:t,strength:p}}if(s.length>1){s.sort((c,l)=>f[c]-f[l]),s.splice(0,s.length-2);let i=Array.from(e.get(s[0]));i.push(...Array.from(e.get(s[1]))),i.map(c=>t.splice(t.indexOf(c),1)),O(t).splice(0,t.length-1);let m="TwoPair",p=[$[m],f[s[1]],f[s[0]],f[t[0][0]]];return t.push(...i),O(t),{hand:m,cards:t,strength:p}}if(s.length>0){let i=Array.from(e.get(s[0]));i.map(c=>t.splice(t.indexOf(c),1)),O(t).splice(0,t.length-3);let m="OnePair",p=[$[m],f[s[0]],f[t[2][0]],f[t[1][0]],f[t[0][0]]];return t.push(...i),O(t),{hand:m,cards:t,strength:p}}{let i="HighCard";O(t),t.splice(0,t.length-5);let m=[$[i],f[t[4][0]],f[t[3][0]],f[t[2][0]],f[t[1][0]],f[t[0][0]]];return{hand:i,cards:t,strength:m}}}var Za=["HighCard","OnePair","TwoPair","ThreeOfAKind","Straight","Flush","FullHouse","FourOfAKind","StraightFlush"];var Rr=class{constructor(t,e){this.i=t,this.o=e}swap(){let t=this.i;this.i=this.o,this.o=t}};var dr=class{constructor(){this.__bpm=0;this.__lastTap=0;this.__lastBeat=0;this.__lastTime=0;this.__calc=new Tt(16)}get beatDuration(){return 60/this.__bpm}get bpm(){return this.__bpm}set bpm(t){this.__lastBeat=this.beat,this.__lastTime=performance.now(),this.__bpm=t}get beat(){return this.__lastBeat+(performance.now()-this.__lastTime)*.001/this.beatDuration}reset(){this.__calc.reset()}nudge(t){this.__lastBeat=this.beat+t,this.__lastTime=performance.now()}tap(){let t=performance.now(),e=(t-this.__lastTap)*.001;2<e?this.reset():(this.__calc.push(e),this.__bpm=60/this.__calc.mean),this.__lastTap=t,this.__lastTime=t,this.__lastBeat=0}};var Mr=class{constructor(t){this.seed=t||1}gen(t){return t&&(this.seed=t),this.seed=this.seed^this.seed<<13,this.seed=this.seed^this.seed>>>17,this.seed=this.seed^this.seed<<5,this.seed/Math.pow(2,32)+.5}set(t){this.seed=t||this.seed||1}};function _r(r,t,e=.5){if(t>=1)return r;if(t<0)return"";let o=Y(0,1-e,t),n=Y(e,1,t),a=1+Math.floor(o*(r.length-1)),s=t<e?0:1+Math.floor(n*(r.length-1)),u=a-s,i=[...Array(u)].map(()=>String.fromCharCode(33+Math.floor(93*Math.random()))).join("");return r.substring(0,s)+i}export{pr as CDS,tt as Clock,lr as ClockFrame,fr as ClockRealtime,W as Euler,xr as ExpSmooth,Jt as GPUTimer,Tt as HistoryMeanCalculator,br as HistoryMedianCalculator,Pt as HistoryPercentileCalculator,bt as MapOfSet,P as Matrix3,R as Matrix4,kt as Pool,_ as Quaternion,Rr as Swap,Vr as TRIANGLE_STRIP_QUAD,Sr as TRIANGLE_STRIP_QUAD_3D,Qr as TRIANGLE_STRIP_QUAD_NORMAL,Cr as TRIANGLE_STRIP_QUAD_UV,dr as TapTempo,Z as Vector,M as Vector3,U as Vector4,Mr as Xorshift,kr as arraySetAdd,cr as arraySetDelete,Pr as arraySetDiff,ur as arraySetHas,Tr as arraySetUnion,xt as binarySearch,_t as clamp,Kr as colorToHex,Ea as createPokerDeck,gt as edt1d,hr as edt2d,Wr as eotfRec709,j as eulerFromMat3,ar as eulerFromMat4,sr as eulerFromQuaternion,Ua as evaluatePokerHand,_r as getYugopText,Wt as lerp,Y as linearstep,vt as mat3Determinant,B as mat3FromMat4,wr as mat3FromMat4Transpose,rt as mat3FromQuaternion,Vt as mat3Inverse,wt as mat3Multiply,St as mat3Transpose,Ft as mat4Compose,Lt as mat4Decompose,st as mat4Determinant,qt as mat4FromMat3,X as mat4FromQuaternion,It as mat4Inverse,zt as mat4LookAt,Ot as mat4LookAtInverse,dt as mat4Multiply,$t as mat4Perspective,Dt as mat4RotateX,Ht as mat4RotateY,Nt as mat4RotateZ,Bt as mat4Scale,Gt as mat4ScaleScalar,Xt as mat4Translate,Ut as mat4Transpose,Lr as matrix2d,qr as matrix3d,ir as mod,te as oetfRec709,$ as pokerHandStrengthMap,Za as pokerHandsByStrength,f as pokerRankStrengthMap,J as pokerRanksByStrength,jt as pokerSuitIndexMap,mr as pokerSuitsByIndex,Yt as quatFromAxisAngle,Kt as quatFromEuler,Et as quatFromMatrix3,mt as quatFromMatrix4,it as quatInverse,K as quatMultiply,Zt as quatNormalize,Br as range,Mt as sanitizeAngle,yt as saturate,Fr as shuffleArray,Xr as smootherstep,Ur as smootheststep,Gr as smoothstep,O as sortPokerCardsByRank,Er as triIndexToLineIndex,Ct as vec3ApplyMatrix4,At as vec3ApplyQuaternion,Q as vec3Cross,at as vec3OrthoNormalize,nt as vec4ApplyMatrix4,H as vecAdd,Qt as vecDivide,V as vecDot,S as vecLength,et as vecLengthSq,ot as vecManhattanLength,Rt as vecMultiply,G as vecNeg,v as vecNormalize,w as vecScale,D as vecSub};
//# sourceMappingURL=0b5vr-experimental.esm.min.js.map
